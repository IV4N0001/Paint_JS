<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--<link rel="stylesheet" href="styles.css">-->
    <title>Document</title>
</head>
<body>
    <canvas id="canvas" style="background-color: rgb(29, 30, 30);" width="1500" height="700"></canvas>
    <script>
        // Obtener el contexto del lienzo
        let canvas = document.getElementById('canvas');
        let ctx = canvas.getContext('2d');

        // Variables para el seguimiento de eventos del mouse
        let isDrawing = false;
        let startX, startY;
        let mouseX, mouseY; // Declare mouseX and mouseY here
        let lines = [];  // Almacenar las coordenadas de los extremos de las líneas dibujadas

        // Algoritmo de Bresenham
        function line(x0, y0, x1, y1, color = 'white') {
            ctx.strokeStyle = color;
            let dx = Math.abs(x1 - x0);
            let dy = Math.abs(y1 - y0);
            let sx = (x0 < x1) ? 1 : -1;
            let sy = (y0 < y1) ? 1 : -1;
            let err = dx - dy;

            while (true) {
                setPixel(x0, y0, color); // Establecer el píxel en las coordenadas actuales
                if ((x0 === x1) && (y0 === y1)) break;
                var e2 = 2 * err;
                if (e2 > -dy) {
                    err -= dy;
                    x0 += sx;
                }
                if (e2 < dx) {
                    err += dx;
                    y0 += sy;
                }
            }
        }

        // Función para establecer un píxel en las coordenadas (x, y)
        function setPixel(x, y, color = 'white') {
            ctx.fillStyle = color;
            ctx.fillRect(x, y, 1, 1);
        }

        // Dibujar todas las líneas almacenadas
        function drawLines() {
            let currentLine = 0
            for (let i = 0; i < lines.length; i++) {
                currentLine = lines[i];
                line(currentLine[0], currentLine[1], currentLine[2], currentLine[3], 'white');
            }
        }

        // Manejadores de eventos del mouse
        canvas.addEventListener('mousedown', function (e) {
            isDrawing = true;
            startX = e.clientX - canvas.getBoundingClientRect().left;
            startY = e.clientY - canvas.getBoundingClientRect().top;
        });

        canvas.addEventListener('mousemove', function (e) {
            if (!isDrawing) return;

            mouseX = e.clientX - canvas.getBoundingClientRect().left;
            mouseY = e.clientY - canvas.getBoundingClientRect().top;

            // Limpiar el canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Dibujar todas las líneas almacenadas
            drawLines();

            // Dibujar la línea actual
            line(startX, startY, mouseX, mouseY, 'white');
        });

        canvas.addEventListener('mouseup', function () {
            if (isDrawing) {
                isDrawing = false;
                lines.push([startX, startY, mouseX, mouseY]);  // Almacenar las coordenadas de la línea dibujada
                // Dibujar todas las líneas almacenadas nuevamente
                drawLines();
            }
        });
    </script>
</body>
</html>
